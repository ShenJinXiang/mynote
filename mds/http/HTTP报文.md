# HTTP报文
如果说HTTP是互联网的心事，那么HTTP报文就是用来搬东西的包裹了

## 报文流
HTTP报文是在HTTP应用程序之间发送的数据块。这些数据块以一些文本形式的元信息(meta-infomation)开头，这些信息描述了报文的内容及含义，后面跟着可选的数据部分，这些报文在客户端、服务器和代理之间流动

### 报文流入源端服务器
HTTP使用术语*流入*(inbound)和*流出*(outbound)来描述*事物处理*(transaction)的方向。报文流入源端服务器，工作完成后，会流回用户的Agent代理中

### 报文向下游流动
HTTP报文会像流水一样流动，不管是请求报文还是响应报文，所有报文都会像下游流动，所有报文的发送者都在接收者的上游

## 报文的组成部分
HTTP报文由三部分组成：对报文进行描述的*起始行*(start line)、包含属性的*首部*(header)块，以及可选的、包含数据的*主体*(body)部分

起始行和首部就是由行分割的ASCII文本。每行都以一个由两个字符组成的行终止序列作为结束，其中包括一个回车符(ASCII码13)和换行符(ASCII码10)

报文的主体是一个可选的数据库，与起始行和首部不同的是，主体中可以包含文本或二进制数据，也可以为空

### 报文的语法
所有的HTTP报文都可以分为两类：*请求报文*(request message)和*响应报文*(response message)。请求报文会向Web服务器请求一个动作。响应报文会将请求的结果返回给客户端。请求和响应报文的基本结构相同

*请求报文的格式：*
> &lt;method&gt; &lt;request-URL&gt; &lt;version&gt;    
> &lt;headers&gt;
>
> &lt;entity-body&gt;

*响应报文的格式：*
> &lt;version&gt; &lt;status&gt; &lt;reason-phrase&gt;    
> &lt;headers&gt;
>
> &lt;entity-body&gt;

**说明**

*方法(method)*

客户端希望服务器对资源执行的动作，一个单独的词，比如 GET、HEAD或POST

*请求URL(request-URL)*

命名了锁请求的资源，或者url路径组件的完整url

*版本(version)*

报文所使用的HTTP版本，格式：

> HTTP/&lt;major&gt;.&lt;minor&gt;

其中*主要版本号*(major)和*次要版本号*(minor)都是整数

*原因短语(reason-phrase)*

数据状态码的可读板块，包括行终止序列之前的所有文本

*首部(header)*

可以有零个或多个首部，每个首部都包含一个名字，后面跟着一个冒号(:)，然后是一个可选的空格，接着是一个值，最后是一个CRLF。首部是由一个空行结束的，表示了首部列表的结束和实体主体部分的开始

*实体的主体部分(entity-body)*

实体的主体部分包含一个任意数据组成的数据库，并不是所有的报文都包含实体的主体部分

### 起始行
所有的HTTP报文都以一个起始行作为开始

**请求行**

包含了一个方法和一个请求URL，还包含了HTTP版本

**响应行**

响应报文承载了状态信息和操作产生的所有结果数据，将其返回给客户端。包含了响应报文使用的HTTP版本、数字状态码以及描述操作状态的文本形式的原因短语

**方法**

请求的起始行以方法作为开始，用来告知服务器要做些什么

*常用HTTP方法*

|方法|描述|是否包含主体|
|:--|:--|:--:|
|GET|从服务器获取一份文档|否|
|HEAD|只从服务器获取文档的首部|否|
|POST|向服务器发送需要处理的数据|是|
|PUT|将请求的主体部分存储在服务器上|是|
|TRACE|将可能经过代理服务器传送到服务器上去的报文进行追踪|否|
|OPTIONS|决定可以在服务器上执行哪些方法|否|
|DELETE|从服务器上删除一份文档|否|

**状态码**

方法是告诉服务器做什么事情的，状态码则用来告诉客户端，发生了什么事情，状态码位于响应的起始行中

*状态码分类*

|整体范围|已定义范围|分类|
|:--:|:--:|:--|
|100 ~ 199|100 ~ 101|信息提示|
|200 ~ 299|200 ~ 206|成功|
|300 ~ 399|300 ~ 305|重定向|
|400 ~ 499|400 ~ 415|客户端错误|
|500 ~ 599|500 ~ 505|服务器错误|

*常见状态码*

|状态码|原因短语|含义|
|200|OK|成功。请求的所有数据都在响应主体中|
|401|Unauthorized(未授权)|需要输入用户名和密码|
|404|Not Found(未找到)|服务器无法找到所请求URL对应的资源|

**原因短语**

原因短语是响应起始行中的最后一个组件，对章台吗提供了文本形式的解释。 原因短语和状态码是成对出现的，原因短语是状态码的可读版本

**版本号**

版本号会以HTTP/x.y 的形式出现在请求和响应报文的起始行中

### 首部
HTTP首部字段向请求和响应报文中添加了一些附加信息，是一些 名/值 对的列表

**首部分类**

HTTP规范定义了几种首部字段，应用程序也可以随意发明自己所用的首部

|分类名称|描述|
|:--|:--|
|通用首部|既可以出现在请求报文中，也可以出现在响应报文中|
|请求首部|提供更多有关请求的信息|
|响应首部|提供更多有关响应的信息|
|实体首部|描述主体的长度和内容，或者资源自身|
|扩展首部|规范中没有定义的新首部|

每个HTTP首部都有一种简单的语法：名字后面跟着冒号(:)，然后跟上可选的空格，再跟上字段值，最后一个是CRLF

*常见的首部实例*

|首部实例|描述|
|Date: Tue,30ct 1997 02:16:03 GMT|服务器产生响应的日期|
|Content-length:15040|实体的主体部分包含了15040字节的数据|
|Content-type:image/gif|实体的主体部分是一个GIF图片|
|Accept: image/gif, image/jpeg, text/html|客户端可以接收GIF图片和JPEG图片以及HTML|

**首部延续行**

将长的首部行分为多行可以提高可读性，多出来的每行前面至少要有一个空格或制表符(tab)

*例如:*
```
HTTP/1.0 200 OK
Content-Type: image/gif
Content-Length: 8572
Server: Test Server
	Version 1.0
```

在这个例子中，响应报文里包含了一个Server首部，值被划分成了多个延续行，首部的完整值为 ```Test Server Version 1.0```

### 实体的主体部分
HTTP报文的第三部分是可选的实体主体的部分。实体的主体是HTTP报文的负荷，就是HTTP要传输的内容

HTTP报文可以承载很多类型的数字数据：图片、视频、HTML文档、软件应用程序、信用卡事务、电子邮件等

## 方法
