# 命令模式
在软件开发中，我们经常需要向某些对象发送请求（调用其中的某个或某些方法），但是并不知道请求的接收者是谁，也不知道被请求的操作是哪个，此时，我们特别希望能够以一种松耦合的方式来设计软件，使得请求发送者与请求接收者能够消除彼此之间的耦合，让对象之间的调用关系更加灵活，可以灵活地指定请求接收者以及被请求的操作。命令模式为此类问题提供了一个较为完美的解决方案

## 定义
将一个请求封装为一个对象，从而让我们可用不同的请求对客户进行参数化；对请求排队或者记录请求日志，以及支持可撤销的操作

## 角色信息
命令模式的核心在于引入了命令类，通过命令类来降低发送者和接收者的耦合度，请求发送者只需指定一个命令对象，再通过命令对象来调用请求接收者的处理方法

* 抽象命令类（Command）：抽象命令类一般是一个抽象类或接口，在其中声明了用于执行请求的`execute()`等方法，通过这些方法可以调用请求接收者的相关操作
* 具体命令类（ConcreteCommand）：具体命令类是抽血命令类的子类，实现了在抽象命令类中声明的方法，对应具体的接收者对象，将接收者对象的动作绑定其中。在实现`execute()`方法时，将调用接收者对象的相关操作
* 调用者（Invoker）：调用者即请求发送者，它通过命令对象来执行请求。一个调用者并不需要在设计时确定其接收者，因此它只与抽象命令类之间存在关联关系。在程序运行时可以将一个具体命令对象注入其中，再调用具体命令对象的execute()方法，从而实现间接调用请求接收者的相关操作
* 接收者（Receiver）：接收者执行与请求相关的操作，它具体实现对请求的业务处理




















```java
public class Adder {

    private int num = 0;

    public int add(int value) {
        this.num += value;
        return this.num;
    }
}
```

```java
public interface Command {

    int execute(int value);

    int undo();

    int redo();
}
```

```java
public class ConcreteCommand implements Command {

    private Adder adder;
    private List<Integer> list;
    private int index;

    public ConcreteCommand() {
        adder = new Adder();
        list = new ArrayList<Integer>();
        list.add(0);
        index = 0;
    }

    @Override
    public int execute(int value) {
        list = list.subList(0, index + 1);
        this.list.add(value);
        this.index++;
        return adder.add(value);
    }

    @Override
    public int undo() {
        return adder.add(-list.get(index--));
    }

    @Override
    public int redo() {
        return adder.add(list.get(++index));
    }
}
```

```java
public class CalculatorForm {

    private Command command;

    public void setCommand(Command command) {
        this.command = command;
    }

    public void compute(int value) {
        int i = command.execute(value);
        System.out.println("运算 + " + value + "，结果：" + i);
    }

    public void undo() {
        int i = command.undo();
        System.out.println("撤销，结果：" + i);
    }

    public void redo() {
        int i = command.redo();
        System.out.println("取消撤销，结果：" + i);
    }
}
```
